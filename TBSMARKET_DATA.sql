--03_AngeloLaMadrid
DROP TABLE VENTA_DETALLE;
DROP TABLE VENTA;
DROP TABLE PRODUCTO;
DROP TABLE CATEGORIA;
DROP TABLE PERSONA ;

CREATE TABLE PERSONA (
  IDPERSONA NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 200 PRIMARY KEY,
  DNIPER VARCHAR2(8),
  NOMPER VARCHAR2(50),
  APEPER VARCHAR2(50),
  EMAPER VARCHAR2(50),
  CELPER VARCHAR2(9),
  TIPPER CHAR(1)CHECK (TIPPER IN ('C', 'V')),
  ESTPER CHAR(1) DEFAULT 'A',
  FECNACPER DATE
);

CREATE TABLE CATEGORIA (
  IDCAT NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 10 INCREMENT BY 10) PRIMARY KEY,
  NOMCAT VARCHAR2(50)
);

CREATE TABLE PRODUCTO (
  CODPROD CHAR(3) PRIMARY KEY,
  NOMPRO VARCHAR2(50),
  PREPRO NUMBER(8,2),
  STOCKPRO INTEGER,
  IDCATPRO REFERENCES CATEGORIA (IDCAT),
  ESTPRO CHAR(1) DEFAULT 'A'
);

CREATE TABLE VENTA (
  IDVEN NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  FECVEN TIMESTAMP DEFAULT SYSTIMESTAMP,
  IDVEND CONSTRAINT FK_VENTA_VENDEDOR REFERENCES PERSONA(IDPERSONA),
  IDCLI  CONSTRAINT FK_VENTA_CLIENTE REFERENCES PERSONA(IDPERSONA),
  TIPPAGVEN CHAR(1),
  ESTVEN CHAR(1) DEFAULT 'A'
);

CREATE TABLE VENTA_DETALLE (
  IDVENDET NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 300 PRIMARY KEY,
  IDVEN REFERENCES VENTA(IDVEN),
  CODPRO REFERENCES PRODUCTO(CODPROD),
  CANVENDET INTEGER
);

/*
--PROBLEMA AL INGRESAR VARIOS REGISTROS DESDE UN SOLO INSERT INTO (Supuestamente ORACLE no soporta este formato)
--03_AngeloLaMadrid

INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER)
VALUES ('77889955', 'Alberto', 'Solano Pariona', 'alberto.pariona@empresa.com', '998456321', 'V', '1970-02-10'),
('45781233', 'Alicia', 'García Campos', 'alicia.garcia@gmail.com', '929185236', 'C', '1980-03-20'),
('15487922', 'Juana', 'Avila Chumpitaz', 'juana.avila@gmail.com', '923568741', 'C', '1990-06-06'),
('22116633', 'Ana', 'Enriquez Flores', 'ana.enrquez@empresa.com', '978848551', 'V', '1970-02-10'),
('88741589', 'Claudia', 'Perales Ortiz', 'Claudia.perales@yahoo.com', '997845263', 'C', '1981-07-25'),
('45122587', 'Mario', 'Barrios Martnez', 'mario.barrios@outlook.com', '986525874', 'C', '1987-10-10'),
('15258564', 'Brunela', 'Tarazona Guerra', 'brunela.tarazona@gmail.com', '986525877', 'C', '1990-06-06');

INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER)
VALUES 
('77889955', 'Alberto', 'Solano Pariona', 'alberto.pariona@empresa.com', '998456321', 'V', DATE '1970-02-10'),
('45781233', 'Alicia', 'García Campos', 'alicia.garcia@gmail.com', '929185236', 'C', DATE '1980-03-20'),
('15487922', 'Juana', 'Avila Chumpitaz', 'juana.avila@gmail.com', '923568741', 'C', DATE '1990-06-06'),
('22116633', 'Ana', 'Enriquez Flores', 'ana.enrquez@empresa.com', '978848551', 'V', DATE '1970-02-10'),
('88741589', 'Claudia', 'Perales Ortiz', 'Claudia.perales@yahoo.com', '997845263', 'C', DATE '1981-07-25'),
('45122587', 'Mario', 'Barrios Martínez', 'mario.barrios@outlook.com', '986525874', 'C', DATE '1987-10-10'),
('15258564', 'Brunela', 'Tarazona Guerra', 'brunela.tarazona@gmail.com', '986525877', 'C', DATE '1990-06-06');
*/

--INSERTAR DATOS

INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('77889955', 'Alberto', 'Solano Pariona', 'alberto.pariona@empresa.com', '998456321', 'V', DATE '1970-02-10');
INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('45781233', 'Alicia', 'García Campos', 'alicia.garcia@gmail.com', '929185236', 'C', DATE '1980-03-20');
INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('15487922', 'Juana', 'Avila Chumpitaz', 'juana.avila@gmail.com', '923568741', 'C', DATE '1990-06-06');
INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('22116633', 'Ana', 'Enriquez Flores', 'ana.enrquez@empresa.com', '978848551', 'V', DATE '1970-02-10');
INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('88741589', 'Claudia', 'Perales Ortiz', 'Claudia.perales@yahoo.com', '997845263', 'C', DATE '1981-07-25');
INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('45122587', 'Mario', 'Barrios Martínez', 'mario.barrios@outlook.com', '986525874', 'C', DATE '1987-10-10');
INSERT INTO PERSONA (DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, FECNACPER) VALUES ('15258564', 'Brunela', 'Tarazona Guerra', 'brunela.tarazona@gmail.com', '986525877', 'C', DATE '1990-06-06');

INSERT INTO  CATEGORIA (NOMCAT) VALUES ('Abarrotes');
INSERT INTO  CATEGORIA (NOMCAT) VALUES ('Carnes y Pollo');
INSERT INTO  CATEGORIA (NOMCAT) VALUES ('Higiene y Limpieza');

INSERT INTO PRODUCTO (CODPROD, NOMPRO, PREPRO, STOCKPRO, IDCATPRO) VALUES ('P01', 'Arroz', 4.65, 50, 10);
INSERT INTO PRODUCTO (CODPROD, NOMPRO, PREPRO, STOCKPRO, IDCATPRO) VALUES ('P02', 'Azucar', 3.45, 60, 10);
INSERT INTO PRODUCTO (CODPROD, NOMPRO, PREPRO, STOCKPRO, IDCATPRO) VALUES ('P03', 'Pollo fresco', 8.70, 20, 20);
INSERT INTO PRODUCTO (CODPROD, NOMPRO, PREPRO, STOCKPRO, IDCATPRO) VALUES ('P04', 'Lomo fino', 18.50, 50, 20);
INSERT INTO PRODUCTO (CODPROD, NOMPRO, PREPRO, STOCKPRO, IDCATPRO) VALUES ('P05', 'Detergente Opal', 8.75, 60, 30);
INSERT INTO PRODUCTO (CODPROD, NOMPRO, PREPRO, STOCKPRO, IDCATPRO) VALUES ('P06', 'Suavizante Ariel', 7.85, 300, 30);

INSERT INTO VENTA (IDVEND, IDCLI, TIPPAGVEN)VALUES (200, 203, 'E');
INSERT INTO VENTA (IDVEND, IDCLI, TIPPAGVEN)VALUES (200, 204, 'T');
INSERT INTO VENTA (IDVEND, IDCLI, TIPPAGVEN)VALUES (203, 205, 'T');
INSERT INTO VENTA (IDVEND, IDCLI, TIPPAGVEN)VALUES (203, 206, 'E');

INSERT INTO VENTA_DETALLE (IDVEN, CODPRO, CANVENDET)VALUES (1, 'P01', 2);
INSERT INTO VENTA_DETALLE (IDVEN, CODPRO, CANVENDET)VALUES (1, 'P04', 4);

--HACER CONSULTAS
SELECT 
    IDPERSONA, DNIPER, NOMPER, APEPER, EMAPER, CELPER, TIPPER, ESTPER, TO_CHAR(FECNACPER, 'DD/MM/YYYY') AS FECNACPER
FROM PERSONA;

SELECT * FROM CATEGORIA;

SELECT * FROM PRODUCTO;

SELECT 
    IDVEN, TO_CHAR(SYSTIMESTAMP, 'DD/MM/YY HH24:MI:SS') AS FECVEN, IDVEND, IDCLI, TIPPAGVEN, ESTVEN
FROM VENTA;

SELECT * FROM VENTA_DETALLE;




